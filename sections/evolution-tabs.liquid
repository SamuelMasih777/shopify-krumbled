{% schema %}
{
  "name": "Evolution Tabs Section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "The Evolution of Krumbled Foods"
    },
    {
      "type": "font_picker",
      "id": "heading_font",
      "label": "Heading Font",
      "default": "serif"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 24,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Heading Size",
      "default": 42
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "top_padding",
      "min": 0,
      "max": 120,
      "step": 10,
      "unit": "px",
      "label": "Top Padding",
      "default": 80
    },
    {
      "type": "range",
      "id": "bottom_padding",
      "min": 0,
      "max": 120,
      "step": 10,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 80
    },
    {
      "type": "header",
      "content": "Tab Button Styling"
    },
    {
      "type": "color",
      "id": "tab_container_bg",
      "label": "Tab Container Background",
      "default": "#f8f4f0"
    },
    {
      "type": "color",
      "id": "tab_text_color",
      "label": "Tab Text Color",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "tab_active_bg",
      "label": "Active Tab Background",
      "default": "#f5e5d8"
    },
    {
      "type": "color",
      "id": "tab_border_color",
      "label": "Tab Border Color",
      "default": "#d4b5a0"
    },
    {
      "type": "header",
      "content": "Content Text Styling"
    },
    {
      "type": "range",
      "id": "content_text_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Content Text Size",
      "default": 14
    },
    {
      "type": "color",
      "id": "content_text_color",
      "label": "Content Text Color",
      "default": "#333333"
    }
  ],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab Panel",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab Button Label",
          "default": "Tab Name"
        },
        {
          "type": "richtext",
          "id": "content_text",
          "label": "Content Text",
          "default": "<p>Add your content here...</p>"
        },
        {
          "type": "image_picker",
          "id": "icon_1",
          "label": "Icon 1"
        },
        {
          "type": "text",
          "id": "icon_1_label",
          "label": "Icon 1 Label"
        },
        {
          "type": "image_picker",
          "id": "icon_2",
          "label": "Icon 2"
        },
        {
          "type": "text",
          "id": "icon_2_label",
          "label": "Icon 2 Label"
        },
        {
          "type": "image_picker",
          "id": "icon_3",
          "label": "Icon 3"
        },
        {
          "type": "text",
          "id": "icon_3_label",
          "label": "Icon 3 Label"
        },
        {
          "type": "image_picker",
          "id": "icon_4",
          "label": "Icon 4"
        },
        {
          "type": "text",
          "id": "icon_4_label",
          "label": "Icon 4 Label"
        },
        {
          "type": "image_picker",
          "id": "icon_5",
          "label": "Icon 5"
        },
        {
          "type": "text",
          "id": "icon_5_label",
          "label": "Icon 5 Label"
        },
        {
          "type": "image_picker",
          "id": "icon_6",
          "label": "Icon 6"
        },
        {
          "type": "text",
          "id": "icon_6_label",
          "label": "Icon 6 Label"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Evolution Tabs",
      "blocks": [
        {
          "type": "tab",
          "settings": {
            "tab_label": "BEAUTY BITES®",
            "content_text": "<p>Body Bites® collagen bars combine illuminating and age-defying ingredients in a convenient snack-only dose.</p><p>They are a delicious 100% natural, non-GMO & gluten-free bars and healthy snacks that can be enjoyed anytime and anywhere. They are pregnancy and breastfeeding safe. However if you are unsure, please consult your physician.</p>",
            "icon_1_label": "GLUTEN FREE",
            "icon_2_label": "NATURAL INGREDIENTS",
            "icon_3_label": "NO ADDED SUGAR",
            "icon_4_label": "LOW SUGAR",
            "icon_5_label": "NON-NATURAL",
            "icon_6_label": "KEEPING AN ACTIVE LIFE"
          }
        },
        {
          "type": "tab",
          "settings": {
            "tab_label": "COLLAGEN",
            "content_text": "<p>An innovative functional formula, with more collagen than most secrets on the market and less than 1.2g grams of sugar per serve.</p><p>Clinically proven to show a reduction in fine lines, increased skin hydration and elasticity, stronger ligaments and improved digestion in just 6 weeks.</p>",
            "icon_1_label": "SKIN",
            "icon_2_label": "HAIR",
            "icon_3_label": "NAILS",
            "icon_4_label": "GUT",
            "icon_5_label": "100% NATURAL",
            "icon_6_label": "KEEPING AN ACTIVE LIFE"
          }
        },
        {
          "type": "tab",
          "settings": {
            "tab_label": "SLEEP SUPPORT",
            "content_text": "<p>Our Advanced Magnesium Hot Chocolate is expertly formulated with a premium blend of sleep inducing ingredients, Magnesium, Ashwagandha, Amino Acids, and Botanicals—designed to ease stress, relax the body, and prime your mind for deep, uninterrupted sleep.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}

<style>
{{ section.settings.heading_font | font_face }}

.evolution-section {
  background-color: {{ section.settings.background_color }};
  padding: {{ section.settings.top_padding }}px 0 {{ section.settings.bottom_padding }}px;
}

.evolution-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 40px;
}

.evolution-heading {
  font-size: {{ section.settings.heading_size }}px;
  font-family: {{ section.settings.heading_font.family }}, {{ section.settings.heading_font.fallback_families }};
  font-weight: 400;
  text-align: center;
  margin-bottom: 40px;
  color: {{ section.settings.heading_color }};
  line-height: 1.2;
}

.tab-buttons {
  display: flex;
  justify-content: center;
  gap: 15px;
  margin-bottom: 40px;
  flex-wrap: wrap;
  background: {{ section.settings.tab_container_bg }};
  padding: 8px;
  border-radius: 50px;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
}

.tab-btn {
  background: transparent;
  border: 1.5px solid transparent;
  padding: 12px 32px;
  border-radius: 50px;
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.3s ease;
  color: {{ section.settings.tab_text_color }};
}

.tab-btn:hover {
  background: {{ section.settings.tab_active_bg }};
  border-color: {{ section.settings.tab_border_color }};
}

.tab-btn.active {
  background: {{ section.settings.tab_active_bg }};
  border-color: {{ section.settings.tab_border_color }};
}

.tab-panels {
  position: relative;
  overflow: hidden;
  min-height: 400px;
}

.tab-content {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  opacity: 0;
  transform: translateX(100%);
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.6s ease;
  pointer-events: none;
}

.tab-content.active {
  position: relative;
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
}

.tab-content.slide-out-left {
  transform: translateX(-100%);
  opacity: 0;
}

.tab-content.slide-in-right {
  transform: translateX(100%);
  opacity: 0;
}

.content-text {
  text-align: center;
  max-width: 900px;
  margin: 0 auto 40px;
  font-size: {{ section.settings.content_text_size }}px;
  line-height: 1.8;
  color: {{ section.settings.content_text_color }};
}

.content-text p {
  margin-bottom: 15px;
}

.icons-grid {
  display: flex;
  justify-content: center;
  gap: 40px;
  flex-wrap: wrap;
  margin-top: 50px;
}

.icon-item {
  text-align: center;
  max-width: 100px;
}

.icon-circle {
  width: 80px;
  height: 80px;
  border: 1.5px solid #d4b5a0;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 12px;
  padding: 15px;
}

.icon-circle img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.icon-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #ccc;
  font-size: 10px;
}

.icon-label {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: #666;
  font-weight: 600;
  line-height: 1.3;
}

@media (max-width: 768px) {
  .evolution-container {
    padding: 0 20px;
  }
  
  .evolution-heading {
    font-size: clamp(28px, 6vw, {{ section.settings.heading_size }}px);
    margin-bottom: 30px;
  }
  
  .tab-buttons {
    gap: 10px;
  }
  
  .tab-btn {
    padding: 10px 24px;
    font-size: 11px;
  }
  
  .content-text {
    font-size: 13px;
  }
  
  .icons-grid {
    gap: 25px;
  }
  
  .icon-circle {
    width: 60px;
    height: 60px;
  }
  
  .icon-item {
    max-width: 80px;
  }
}
</style>

<section class="evolution-section">
  <div class="evolution-container">
    {% if section.settings.heading != blank %}
      <h2 class="evolution-heading">{{ section.settings.heading }}</h2>
    {% endif %}
    
    {% if section.blocks.size > 0 %}
      <div class="tab-buttons">
        {% for block in section.blocks %}
          <button 
            class="tab-btn {% if forloop.first %}active{% endif %}" 
            data-tab="tab-{{ block.id }}"
            {{ block.shopify_attributes }}
          >
            {{ block.settings.tab_label }}
          </button>
        {% endfor %}
      </div>
      
      <div class="tab-panels">
        {% for block in section.blocks %}
          <div 
            class="tab-content {% if forloop.first %}active{% endif %}" 
            id="tab-{{ block.id }}"
          >
            {% if block.settings.content_text != blank %}
              <div class="content-text">
                {{ block.settings.content_text }}
              </div>
            {% endif %}
            
            <div class="icons-grid">
              {% if block.settings.icon_1 or block.settings.icon_1_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_1 %}
                      <img src="{{ block.settings.icon_1 | image_url: width: 80 }}" alt="{{ block.settings.icon_1_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_1_label %}
                    <p class="icon-label">{{ block.settings.icon_1_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.icon_2 or block.settings.icon_2_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_2 %}
                      <img src="{{ block.settings.icon_2 | image_url: width: 80 }}" alt="{{ block.settings.icon_2_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_2_label %}
                    <p class="icon-label">{{ block.settings.icon_2_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.icon_3 or block.settings.icon_3_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_3 %}
                      <img src="{{ block.settings.icon_3 | image_url: width: 80 }}" alt="{{ block.settings.icon_3_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_3_label %}
                    <p class="icon-label">{{ block.settings.icon_3_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.icon_4 or block.settings.icon_4_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_4 %}
                      <img src="{{ block.settings.icon_4 | image_url: width: 80 }}" alt="{{ block.settings.icon_4_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_4_label %}
                    <p class="icon-label">{{ block.settings.icon_4_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.icon_5 or block.settings.icon_5_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_5 %}
                      <img src="{{ block.settings.icon_5 | image_url: width: 80 }}" alt="{{ block.settings.icon_5_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_5_label %}
                    <p class="icon-label">{{ block.settings.icon_5_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
              
              {% if block.settings.icon_6 or block.settings.icon_6_label %}
                <div class="icon-item">
                  <div class="icon-circle">
                    {% if block.settings.icon_6 %}
                      <img src="{{ block.settings.icon_6 | image_url: width: 80 }}" alt="{{ block.settings.icon_6_label }}">
                    {% else %}
                      <div class="icon-placeholder">Icon</div>
                    {% endif %}
                  </div>
                  {% if block.settings.icon_6_label %}
                    <p class="icon-label">{{ block.settings.icon_6_label }}</p>
                  {% endif %}
                </div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p style="text-align: center; color: #999;">Add tab panels in the theme editor</p>
    {% endif %}
  </div>
</section>

<script>
(function() {
  const tabButtons = document.querySelectorAll('.tab-btn');
  const tabContents = document.querySelectorAll('.tab-content');
  let currentIndex = 0;
  
  tabButtons.forEach((button, index) => {
    button.addEventListener('click', () => {
      if (index === currentIndex) return; // Don't animate if same tab
      
      const targetTab = button.getAttribute('data-tab');
      const direction = index > currentIndex ? 'left' : 'right';
      
      // Remove active class from all buttons
      tabButtons.forEach(btn => btn.classList.remove('active'));
      
      // Get current and next content
      const currentContent = tabContents[currentIndex];
      const nextContent = document.getElementById(targetTab);
      
      // Slide out current content
      if (direction === 'left') {
        currentContent.classList.add('slide-out-left');
      } else {
        currentContent.style.transform = 'translateX(100%)';
      }
      currentContent.classList.remove('active');
      
      // Prepare next content
      if (direction === 'left') {
        nextContent.style.transform = 'translateX(100%)';
      } else {
        nextContent.style.transform = 'translateX(-100%)';
      }
      nextContent.style.opacity = '0';
      
      // Trigger reflow
      nextContent.offsetHeight;
      
      // Slide in next content
      setTimeout(() => {
        nextContent.classList.add('active');
        nextContent.style.transform = 'translateX(0)';
        nextContent.style.opacity = '1';
      }, 50);
      
      // Add active class to clicked button
      button.classList.add('active');
      
      // Update current index
      currentIndex = index;
      
      // Clean up after transition
      setTimeout(() => {
        currentContent.classList.remove('slide-out-left');
        currentContent.style.transform = '';
      }, 600);
    });
  });
})();
</script>
