{% comment %}
  Bestseller Card Snippet
  Usage: {% render 'bestseller-card', product: product, section: section, block_settings: block.settings %}
{% endcomment %}

{% assign title = block_settings.custom_title | default: product.title %}
{% assign vendor = block_settings.custom_vendor | default: product.type | upcase %}
{% assign image = block_settings.custom_image | default: product.featured_image %}
{% assign reviews = block_settings.review_count | default: '148 Reviews' %}
{% assign rating = block_settings.star_rating | default: 5 %}
{% assign price = block_settings.custom_price | default: product.price | money %}
{% assign compare_price = product.compare_at_price | money %}
{% assign badge_image = block_settings.custom_badge %}

<div class="bestseller-card" style="text-align: {{ section.settings.text_alignment }};">
  <div class="bestseller-badge">
    {% if badge_image != blank %}
      <img src="{{ badge_image | image_url: width: 200 }}" alt="Badge" loading="lazy">
    {% endif %}
  </div>
  
  <a href="{{ product.url }}" class="bestseller-link">
    <div class="bestseller-image">
      {% if image %}
        <img src="{{ image | image_url: width: 600 }}" alt="{{ title }}" loading="lazy">
      {% else %}
        <div class="no-image">No Image</div>
      {% endif %}
    </div>
    
    <div class="bestseller-info" style="align-items: {% if section.settings.text_alignment == 'center' %}center{% else %}flex-start{% endif %};">
      <div class="bestseller-row-top">
        <p class="bestseller-vendor">{{ vendor }}</p>
        
        <div class="bestseller-rating-row">
          <div class="bestseller-rating">
            {% for i in (1..5) %}
              <span class="stars" style="color: {{ section.settings.star_color | default: '#ffc107' }}">
                {% if i <= rating %}★{% else %}☆{% endif %}
              </span>
            {% endfor %}
          </div>
          <span class="review-count">{{ reviews }}</span>
        </div>
      </div>

      <div class="bestseller-row-bottom">
        <h3 class="bestseller-title">{{ title }}</h3>
        
        <div class="bestseller-price-row">
          {% if product.compare_at_price > product.price and block_settings.custom_price == blank %}
            <span class="bestseller-compare-price">{{ compare_price }}</span>
          {% endif %}
          <span class="bestseller-price">{{ price }}</span>
        </div>
      </div>
    </div>
  </a>
  
  <form action="/cart/add" method="post">
    <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
    <button type="submit" class="bestseller-add-to-cart">ADD TO CART</button>
  </form>
</div>
