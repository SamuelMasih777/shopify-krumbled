{% schema %}
{
  "name": "Main Product",
  "settings": [
    {
       "type": "header",
       "content": "Krumbled Layout Settings"
    },
    {
      "type": "font_picker",
      "id": "krumbled_heading_font",
      "label": "Heading Font",
      "default": "serif"
    },
    {
       "type": "color",
       "id": "krumbled_accent_color",
       "label": "Accent Color",
       "default": "#e9427c"
    },
    {
       "type": "header",
       "content": "Collapsible Settings"
    },
    {
       "type": "color",
       "id": "collapsible_text_color",
       "label": "Collapsible Title Color",
       "default": "#000000"
    },
     {
       "type": "color",
       "id": "collapsible_active_color",
       "label": "Collapsible Active Color",
       "default": "#e9427c"
    }
  ],
  "blocks": [
    {
      "type": "collapsible_tab",
      "name": "Collapsible Row",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Collapsible Row"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Row Content"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Row Content from Page"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Main Product"
    }
  ]
}
{% endschema %}

{% assign brand = product.metafields.custom.brand | downcase %}

<script>
  console.log("DEBUG: Main Product Section Loaded");
  console.log("DEBUG: Raw Metafield Value:", "{{ product.metafields.custom.brand }}");
  console.log("DEBUG: Processed Brand Variable:", "{{ brand }}");
</script>

<div style="background: yellow; color: black; padding: 10px; font-weight: bold; text-align: center; border: 2px solid red;">
  DEBUG MODE: Brand is "{{ brand }}" (Raw: "{{ product.metafields.custom.brand }}")
</div>

{% if brand contains 'mini' %}
  {% render 'product-mini-me' %}
{% elsif brand contains 'krumbled' %}
  {% render 'product-krumbled' %}
{% elsif brand contains 'habitual' %}
  {% render 'product-habitual-beauty' %}
{% else %}
  {% render 'product-default' %}
{% endif %}
